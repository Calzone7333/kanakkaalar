import{j as e}from"./ui-Ch41-bI7.js";import{b as A,r as i}from"./vendor-Con1GFA2.js";import{S as R}from"./StatCard-bJQXbmDD.js";import{m as n}from"./index-DOyQY1V8.js";import{U as m}from"./users-BGsoqPKS.js";import{F as b}from"./file-text-0c8R3v66.js";import{C as z}from"./clock-1sUlJ8Ou.js";import{W as p}from"./wallet-BLf0THid.js";import{B}from"./building-ByZHRTDh.js";import{P}from"./plus-BU_M-nSH.js";import{C as q}from"./chevron-right-CGcCF62D.js";import{A as D}from"./arrow-up-right-uAuO2zaM.js";import{B as E}from"./bell-DpC3lfXC.js";import"./trending-up-B2cijUDO.js";import"./trending-down-BZz3eVSk.js";import"./utils-BMGruD9E.js";const _=()=>{const r=A(),[j,x]=i.useState(!0),[l,v]=i.useState({totalCustomers:0,activeServices:0,pendingRequests:0,totalRevenue:0}),[g,f]=i.useState([]),[h,y]=i.useState([]);i.useEffect(()=>{N()},[]);const N=async()=>{try{x(!0);const s=await n.getDashboardStats();v({totalCustomers:s.data.totalCustomers||0,activeServices:s.data.activeServices||0,pendingRequests:s.data.pendingRequests||0,totalRevenue:s.data.totalRevenue||0});const C=((await n.getAllProfiles()).data||[]).slice(0,5).map(t=>{var a,c,u;return{id:t.id,name:((a=t.user)==null?void 0:a.fullName)||"N/A",email:((c=t.user)==null?void 0:c.email)||"N/A",phone:((u=t.user)==null?void 0:u.phone)||t.whatsappNumber||"N/A",status:t.status||"Active",kycStatus:t.kycStatus||"Pending",services:0}});f(C);const S=(await n.getAllServiceRequests()).data||[],d={};S.forEach(t=>{const a=t.serviceName||"Other";d[a]=(d[a]||0)+1});const k=Object.entries(d).slice(0,4).map(([t,a],c)=>({label:t,count:a,color:["bg-blue-500","bg-green-500","bg-purple-500","bg-amber-500"][c]}));y(k)}catch(s){console.error("Error fetching dashboard data:",s)}finally{x(!1)}},w=[{title:"Total Customers",value:l.totalCustomers.toString(),icon:e.jsx(m,{className:"w-6 h-6"}),change:12.5,bgColor:"bg-blue-50",iconColor:"text-blue-600"},{title:"Active Services",value:l.activeServices.toString(),icon:e.jsx(b,{className:"w-6 h-6"}),change:8.2,bgColor:"bg-purple-50",iconColor:"text-purple-600"},{title:"Pending Requests",value:l.pendingRequests.toString(),icon:e.jsx(z,{className:"w-6 h-6"}),change:-2.4,bgColor:"bg-amber-50",iconColor:"text-amber-600"},{title:"Total Revenue",value:`â‚¹${(l.totalRevenue/1e5).toFixed(1)}L`,icon:e.jsx(p,{className:"w-6 h-6"}),change:15.3,bgColor:"bg-green-50",iconColor:"text-green-600"}];return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"CRM Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage your B2C customers, services, and support."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>r("/dashboard/admin/crm/companies"),className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors flex items-center gap-2",children:[e.jsx(B,{size:18}),"Companies"]}),e.jsx("button",{onClick:()=>r("/dashboard/admin/crm/customers"),className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors",children:"View All Customers"}),e.jsxs("button",{onClick:()=>r("/dashboard/admin/crm/customers"),className:"px-4 py-2 bg-[#0189BB] text-white rounded-lg hover:bg-[#017a9b] font-medium transition-colors flex items-center gap-2",children:[e.jsx(P,{size:18}),"Add Customer"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map((s,o)=>e.jsx(R,{...s},o))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Customers"}),e.jsxs("button",{onClick:()=>r("/dashboard/admin/crm/customers"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center",children:["View All ",e.jsx(q,{size:16})]})]}),e.jsx("div",{className:"overflow-x-auto",children:g.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(m,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{children:"No customers found. Add your first customer to get started!"})]}):e.jsxs("table",{className:"w-full text-left text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-xs uppercase font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Customer"}),e.jsx("th",{className:"px-6 py-4",children:"Contact"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4",children:"Services"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xs",children:s.name.charAt(0)}),s.name]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.email}),e.jsx("span",{className:"text-xs text-gray-400",children:s.phone})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium
                          ${s.status==="Active"?"bg-green-100 text-green-700":s.status==="Pending"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-700"}`,children:s.status})}),e.jsxs("td",{className:"px-6 py-4",children:[s.services," Active"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>r(`/dashboard/admin/crm/customer/${s.id}`),className:"text-gray-400 hover:text-blue-600 transition-colors",children:e.jsx(D,{size:18})})})]},s.id))})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#0189BB] to-[#01688f] rounded-xl p-6 text-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"bg-white/10 hover:bg-white/20 p-3 rounded-lg text-sm font-medium transition-colors text-left flex flex-col gap-2",children:[e.jsx(b,{size:20}),"New Service"]}),e.jsxs("button",{onClick:()=>r("/dashboard/admin/leads"),className:"bg-white/10 hover:bg-white/20 p-3 rounded-lg text-sm font-medium transition-colors text-left flex flex-col gap-2",children:[e.jsx(m,{size:20}),"Add Lead"]}),e.jsxs("button",{className:"bg-white/10 hover:bg-white/20 p-3 rounded-lg text-sm font-medium transition-colors text-left flex flex-col gap-2",children:[e.jsx(p,{size:20}),"Add Money"]}),e.jsxs("button",{className:"bg-white/10 hover:bg-white/20 p-3 rounded-lg text-sm font-medium transition-colors text-left flex flex-col gap-2",children:[e.jsx(E,{size:20}),"Send Alert"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Service Overview"}),e.jsx("div",{className:"space-y-4",children:h.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No services yet"}):h.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.color}`}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.label})]}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:s.count})]},o))})]})]})]})]})};export{_ as default};
