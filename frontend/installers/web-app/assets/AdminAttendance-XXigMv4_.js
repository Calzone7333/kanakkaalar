import{j as e}from"./ui-Ch41-bI7.js";import{r as n}from"./vendor-Con1GFA2.js";import{S as v}from"./StatCard-bJQXbmDD.js";import{D as R}from"./DataTable-BQ4BDS1t.js";import{C as x}from"./ChartCard-jjp_hlOM.js";import{i as l}from"./index-DOyQY1V8.js";import{C as O}from"./circle-check-big-D8OHe7YR.js";import{C as P}from"./clock-1sUlJ8Ou.js";import{C as E}from"./circle-alert-BFwnVd39.js";import{C as F}from"./calendar-xrUQgiti.js";import{R as b,e as I,C as B,X as W,Y as K,T as p,L as $,f as c,P as M,b as z,c as X}from"./charts-lRoDuk9d.js";import"./trending-up-B2cijUDO.js";import"./trending-down-BZz3eVSk.js";import"./plus-BU_M-nSH.js";import"./search-D_R02uDR.js";import"./trash-2-z8U7xTc_.js";import"./utils-BMGruD9E.js";const ce=()=>{var m,h,g;const[k,u]=n.useState([]),[f,y]=n.useState(!0),[r,j]=n.useState({present:0,absent:0,late:0,attendanceRate:"0.0"}),[C,i]=n.useState([]);n.useEffect(()=>{S(),w(),T()},[]);const S=async()=>{try{const s=(await l.getAll()).data||[],L=new Date().toISOString().split("T")[0],N=s.filter(a=>new Date(a.date).toISOString().split("T")[0]===L).map(a=>{var o;return{id:a.id,name:((o=a.user)==null?void 0:o.fullName)||"Unknown",date:new Date(a.date).toLocaleDateString(),checkIn:a.checkInTime?new Date(a.checkInTime).toLocaleTimeString():"—",checkOut:a.checkOutTime?new Date(a.checkOutTime).toLocaleTimeString():"—",duration:a.duration||(a.checkOutTime?"In Progress":"0h"),status:a.status||"Present"}});u(N)}catch(t){console.error("Failed to fetch attendance",t)}finally{y(!1)}},w=async()=>{try{const t=await l.getStats();j(t.data)}catch(t){console.error("Failed to fetch stats",t)}},T=async()=>{try{const t=await l.getTrend();i(t.data||[])}catch(t){console.error("Failed to fetch trend",t),i([{week:"Week 1",present:95,absent:5,late:3},{week:"Week 2",present:96,absent:4,late:2},{week:"Week 3",present:94,absent:6,late:4},{week:"Week 4",present:97,absent:3,late:1}])}},d=[{name:"Present",value:Number(r.present)||0},{name:"Absent",value:Number(r.absent)||0},{name:"Late",value:Number(r.late)||0}],A=[{title:"Present Today",value:((m=r.present)==null?void 0:m.toString())||"0",icon:e.jsx(O,{className:"w-6 h-6"}),change:1.2,bgColor:"bg-green-50",iconColor:"text-green-600"},{title:"Late Arrivals",value:((h=r.late)==null?void 0:h.toString())||"0",icon:e.jsx(P,{className:"w-6 h-6"}),change:0,bgColor:"bg-amber-50",iconColor:"text-amber-600"},{title:"Absent",value:((g=r.absent)==null?void 0:g.toString())||"0",icon:e.jsx(E,{className:"w-6 h-6"}),change:-2.1,bgColor:"bg-red-50",iconColor:"text-red-600"},{title:"Attendance Rate",value:`${r.attendanceRate}%`,icon:e.jsx(F,{className:"w-6 h-6"}),change:.8,bgColor:"bg-blue-50",iconColor:"text-blue-600"}],D=["#10B981","#EF4444","#F59E0B"];return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Attendance Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Track and manage employee attendance (Office hours: 9:30 AM - Late after 9:45 AM)"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:A.map((t,s)=>e.jsx(v,{...t},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(x,{title:"Attendance Trend",subtitle:"Weekly attendance overview (Last 4 weeks)",children:e.jsx(b,{width:"100%",height:300,children:e.jsxs(I,{data:C,children:[e.jsx(B,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(W,{dataKey:"week",stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(K,{stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(p,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx($,{}),e.jsx(c,{type:"monotone",dataKey:"present",stroke:"#10B981",strokeWidth:2,dot:{fill:"#10B981",r:4},name:"Present"}),e.jsx(c,{type:"monotone",dataKey:"late",stroke:"#F59E0B",strokeWidth:2,dot:{fill:"#F59E0B",r:4},name:"Late"}),e.jsx(c,{type:"monotone",dataKey:"absent",stroke:"#EF4444",strokeWidth:2,dot:{fill:"#EF4444",r:4},name:"Absent"})]})})})}),e.jsx(x,{title:"Today's Status",subtitle:"Breakdown",children:e.jsx(b,{width:"100%",height:300,children:e.jsxs(M,{children:[e.jsx(z,{data:d,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,value:s})=>`${t}: ${s}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:d.map((t,s)=>e.jsx(X,{fill:D[s]},`cell-${s}`))}),e.jsx(p,{})]})})})]}),e.jsx(R,{loading:f,title:"Today's Attendance",columns:[{key:"name",label:"Employee Name"},{key:"date",label:"Date"},{key:"checkIn",label:"Check In"},{key:"checkOut",label:"Check Out"},{key:"duration",label:"Duration"},{key:"status",label:"Status",render:t=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${t==="Present"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":t==="Late"?"bg-amber-100 text-amber-700 dark:bg-amber-900/20 dark:text-amber-400":"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400"}`,children:t})}],data:k,searchPlaceholder:"Search by employee name..."})]})};export{ce as default};
