import{j as e}from"./ui-Ch41-bI7.js";import{r as l}from"./vendor-Con1GFA2.js";import{S as X}from"./StatCard-bJQXbmDD.js";import{D as Y}from"./DataTable-BQ4BDS1t.js";import{X as D,h as w,P as B}from"./index-DOyQY1V8.js";import{U as J,C as _}from"./ConfirmationModal-DiYWS2op.js";import{U as G}from"./users-BGsoqPKS.js";import{U as H}from"./user-check-QseFzR49.js";import{S as K}from"./square-pen-BrLxDoPl.js";import{T as Q}from"./trash-2-z8U7xTc_.js";import{E as W}from"./eye-CrwWX6CR.js";import"./trending-up-B2cijUDO.js";import"./trending-down-BZz3eVSk.js";import"./plus-BU_M-nSH.js";import"./search-D_R02uDR.js";import"./utils-BMGruD9E.js";import"./triangle-alert-D1sp6RMM.js";const Z=({isOpen:a,onClose:n,onSuccess:s,employeeToEdit:i})=>{const r=!!i,[d,u]=l.useState({fullName:"",email:"",password:"",role:"EMPLOYEE"}),[N,x]=l.useState(""),[f,j]=l.useState(!1),g=h=>{const{name:m,value:p}=h.target;u(y=>({...y,[m]:p}))};l.useEffect(()=>{r&&i&&u({fullName:i.fullName||"",email:i.email||"",password:"",role:i.role||"EMPLOYEE"})},[i,r,a]);const C=async h=>{var p,y;if(h.preventDefault(),x(""),!d.fullName||!d.email||!r&&!d.password){x("All fields are required.");return}if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(d.email)){x("Please enter a valid email address.");return}j(!0);try{let o;if(r){const{password:v,...E}=d;o=await w.updateEmployee(i.id,E)}else o=await w.createEmployee(d);o!=null&&o.data?(s&&s(o.data),n()):x("Unexpected response from server.")}catch(o){console.error("Add employee error:",o);const v=r?"update":"add";x(((y=(p=o==null?void 0:o.response)==null?void 0:p.data)==null?void 0:y.message)||`Failed to ${v} employee.`)}finally{j(!1)}};return a?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 w-full max-w-md relative animate-fade-in",children:[e.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",children:e.jsx(D,{size:24})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:r?"Edit Employee":"Add New Employee"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",name:"fullName",value:d.fullName,onChange:g,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:d.email,onChange:g,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:d.password,onChange:g,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),N&&e.jsx("p",{className:"text-sm text-red-600",children:N}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300",children:f?r?"Saving...":"Adding...":r?"Save Changes":"Add Employee"})]})]})]})}):null},b=({label:a,value:n,children:s})=>e.jsxs("div",{className:"py-4 sm:grid sm:grid-cols-3 sm:gap-4",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:a}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:s||n})]}),ee=a=>{switch(a){case"ACTIVE":return"bg-green-100 text-green-700";case"INACTIVE":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},te=({employee:a,isOpen:n,onClose:s})=>{if(!n||!a)return null;const i=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:s,className:"fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity","aria-hidden":"true"}),e.jsx("div",{className:`fixed top-0 right-0 bottom-0 w-full max-w-md bg-white shadow-xl z-50 transform transition-transform ease-in-out duration-300 ${n?"translate-x-0":"translate-x-full"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Employee Details"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:e.jsx(D,{size:24})})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a.fullName})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("dl",{className:"divide-y divide-gray-200",children:[e.jsx(b,{label:"Full Name",value:a.fullName}),e.jsx(b,{label:"Email Address",value:a.email}),e.jsx(b,{label:"Role",value:a.role}),e.jsx(b,{label:"Status",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${ee(a.status)}`,children:a.status})}),e.jsx(b,{label:"Date Joined",value:i(a.createdAt)}),e.jsx(b,{label:"Last Updated",value:i(a.updatedAt)})]})})]})})]})},be=()=>{const[a,n]=l.useState([]),[s,i]=l.useState({totalEmployees:0,activeEmployees:0,inactiveEmployees:0}),[r,d]=l.useState(!0),[u,N]=l.useState(""),[x,f]=l.useState(!1),[j,g]=l.useState(null),[C,h]=l.useState(!1),[m,p]=l.useState(null),[y,o]=l.useState(!1),[v,E]=l.useState(!1),[M,P]=l.useState(null);l.useEffect(()=>{S()},[]);const S=async()=>{d(!0);try{const t=await w.listEmployees();n(t.data.employees||[]),i(t.data.stats||{totalEmployees:0,activeEmployees:0,inactiveEmployees:0})}catch(t){console.error("Failed to fetch employees:",t)}finally{d(!1)}},L=()=>{g(null),f(!0)},I=t=>{g(t),f(!0)},O=()=>{f(!1),g(null)},T=t=>{n(j?c=>c.map(A=>A.id===t.id?t:A):c=>[t,...c]),S()},U=t=>{p(t),h(!0)},k=()=>{p(null),h(!1)},V=async()=>{if(m){o(!0);try{await w.deleteEmployee(m.id),n(t=>t.filter(c=>c.id!==m.id)),k(),S()}catch(t){console.error("Failed to delete employee:",t)}finally{o(!1)}}},F=t=>{P(t),E(!0)},z=()=>{E(!1)},$=[{title:"Total Employees",value:(s==null?void 0:s.totalEmployees)||0,icon:e.jsx(G,{className:"w-6 h-6"}),bgColor:"bg-blue-50",iconColor:"text-blue-600"},{title:"Active Employees",value:(s==null?void 0:s.activeEmployees)||0,icon:e.jsx(H,{className:"w-6 h-6"}),bgColor:"bg-green-50",iconColor:"text-green-600"},{title:"Inactive Employees",value:(s==null?void 0:s.inactiveEmployees)||0,icon:e.jsx(J,{className:"w-6 h-6"}),bgColor:"bg-red-50",iconColor:"text-red-600"}],q=t=>{switch(t){case"ACTIVE":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400";case"INACTIVE":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},R=l.useMemo(()=>u?a.filter(t=>t.fullName.toLowerCase().includes(u.toLowerCase())||t.email.toLowerCase().includes(u.toLowerCase())):a,[a,u]);return r&&a.length===0?e.jsx(B,{show:!0}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Employee Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"View, manage, and track all employees in your organization."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map((t,c)=>e.jsx(X,{...t,loading:r},c))}),e.jsx(Y,{loading:r,title:"All Employees",columns:[{key:"fullName",label:"Name"},{key:"email",label:"Email"},{key:"role",label:"Role"},{key:"status",label:"Status",render:t=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${q(t)}`,children:t})},{key:"actions",label:"Actions",render:(t,c)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>I(c),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Edit Employee",children:e.jsx(K,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>U(c),className:"text-red-600 hover:text-red-800 transition-colors",title:"Delete Employee",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>F(c),className:"text-gray-600 hover:text-gray-800 transition-colors",title:"View Details",children:e.jsx(W,{className:"w-5 h-5"})})]})}],data:R,onAdd:L,searchPlaceholder:"Search by name or email...",searchTerm:u,onSearchChange:t=>N(t.target.value)}),e.jsx(Z,{isOpen:x,onClose:O,onSuccess:T,employeeToEdit:j}),e.jsx(_,{isOpen:C,onClose:k,onConfirm:V,loading:y,title:"Delete Employee",message:`Are you sure you want to delete ${m==null?void 0:m.fullName}? This action cannot be undone.`}),e.jsx(te,{isOpen:v,onClose:z,employee:M})]})};export{be as default};
