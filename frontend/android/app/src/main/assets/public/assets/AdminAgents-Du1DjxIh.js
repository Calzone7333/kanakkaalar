import{j as e}from"./ui-Ch41-bI7.js";import{r as n}from"./vendor-Con1GFA2.js";import{S as H}from"./StatCard-Dumc55b0.js";import{D as V}from"./DataTable-D4UWD7Zb.js";import{c as q,X as E,i as w,P as $}from"./index-SiRpZdc4.js";import{U as z,C as R}from"./ConfirmationModal-zf42vPVi.js";import{U as _}from"./users-Bdz3eiSd.js";import{U as X}from"./user-check-DjUL1F5B.js";import{S as W}from"./square-pen-D8nIDyhw.js";import{T as G}from"./trash-2-i4V96l9G.js";import"./trending-up-WamTlgRe.js";import"./trending-down-DEibCJBa.js";import"./plus-BBYXCYuW.js";import"./search-C-O3bJ5K.js";import"./utils-BMGruD9E.js";import"./triangle-alert-KDMv3I0P.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],K=q("power",J),Q=({isOpen:p,onClose:m,onSuccess:c,agentToEdit:t})=>{const o=!!t,[s,g]=n.useState({fullName:"",email:"",password:"",phone:"",address:"",state:"",city:"",firmName:"",referralCode:"",aadhaarNumber:"",panNumber:"",bankHolderName:"",bankAccountNumber:"",bankIfsc:"",bankName:""}),[x,C]=n.useState({aadhaarFront:null,aadhaarBack:null,panCard:null}),[j,b]=n.useState(""),[k,A]=n.useState(!1),r=N=>{const{name:y,value:d}=N.target;g(h=>({...h,[y]:d}))},u=N=>{const{name:y,files:d}=N.target;d&&d[0]&&C(h=>({...h,[y]:d[0]}))};n.useEffect(()=>{o&&t?g({fullName:t.fullName||"",email:t.email||"",password:"",phone:t.phone||"",address:t.address||"",state:t.state||"",city:t.city||"",firmName:t.firmName||"",referralCode:t.referralCode||"",aadhaarNumber:t.aadhaarNumber||"",panNumber:t.panNumber||"",bankHolderName:t.bankHolderName||"",bankAccountNumber:t.bankAccountNumber||"",bankIfsc:t.bankIfsc||"",bankName:t.bankName||""}):(g({fullName:"",email:"",password:"",phone:"",address:"",state:"",city:"",firmName:"",referralCode:"",aadhaarNumber:"",panNumber:"",bankHolderName:"",bankAccountNumber:"",bankIfsc:"",bankName:""}),C({aadhaarFront:null,aadhaarBack:null,panCard:null}))},[t,o,p]);const S=async N=>{var d,h;if(N.preventDefault(),b(""),!s.fullName||!s.email||!o&&!s.password||!s.phone){b("Required fields: Name, Email, Phone, and Password (if new).");return}if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(s.email)){b("Please enter a valid email address.");return}A(!0);try{const i=new FormData;Object.keys(s).forEach(I=>{i.append(I,s[I])}),x.aadhaarFront&&i.append("aadhaarFront",x.aadhaarFront),x.aadhaarBack&&i.append("aadhaarBack",x.aadhaarBack),x.panCard&&i.append("panCard",x.panCard);let f;o?f=await w.updateAgent(t.id,i):f=await w.createAgent(i),f!=null&&f.data?(c&&c(f.data),m()):b("Unexpected response from server.")}catch(i){console.error("Add agent error:",i);const f=o?"update":"add";b(((h=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:h.message)||`Failed to ${f} agent.`)}finally{A(!1)}};return p?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-4xl relative animate-fade-in max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("button",{onClick:m,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 z-10",children:e.jsx(E,{size:24})}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 flex-shrink-0",children:o?"Edit Agent":"Add New Agent"}),e.jsxs("form",{onSubmit:S,className:"space-y-4 overflow-y-auto pr-2 flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-700 border-b pb-1",children:"Personal Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name *"}),e.jsx("input",{type:"text",name:"fullName",value:s.fullName,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number *"}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),!o&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password *"}),e.jsx("input",{type:"password",name:"password",value:s.password,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 border-b pb-1 pt-2",children:"Address Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("textarea",{name:"address",value:s.address,onChange:r,rows:"2",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),e.jsx("input",{type:"text",name:"state",value:s.state,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:s.city,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 border-b pb-1 pt-2",children:"Professional & Identity"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Firm Name (Optional)"}),e.jsx("input",{type:"text",name:"firmName",value:s.firmName,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Referral Code (Optional)"}),e.jsx("input",{type:"text",name:"referralCode",value:s.referralCode,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Aadhaar Number"}),e.jsx("input",{type:"text",name:"aadhaarNumber",value:s.aadhaarNumber,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PAN Number"}),e.jsx("input",{type:"text",name:"panNumber",value:s.panNumber,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 border-b pb-1 pt-2",children:"Documents Upload"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Aadhaar Front"}),e.jsx("input",{type:"file",name:"aadhaarFront",onChange:u,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Aadhaar Back"}),e.jsx("input",{type:"file",name:"aadhaarBack",onChange:u,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PAN Card"}),e.jsx("input",{type:"file",name:"panCard",onChange:u,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 border-b pb-1 pt-2",children:"Bank Details (For Commission)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Holder Name"}),e.jsx("input",{type:"text",name:"bankHolderName",value:s.bankHolderName,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Number"}),e.jsx("input",{type:"text",name:"bankAccountNumber",value:s.bankAccountNumber,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"IFSC Code"}),e.jsx("input",{type:"text",name:"bankIfsc",value:s.bankIfsc,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bankName",value:s.bankName,onChange:r,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),j&&e.jsx("p",{className:"text-sm text-red-600",children:j}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t mt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:k,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300",children:k?o?"Saving...":"Adding...":o?"Save Changes":"Add Agent"})]})]})]})}):null},fe=()=>{const[p,m]=n.useState([]),[c,t]=n.useState({totalAgents:0,activeAgents:0,inactiveAgents:0}),[o,s]=n.useState(!0),[g,x]=n.useState(""),[C,j]=n.useState(!1),[b,k]=n.useState(null),[A,r]=n.useState(!1),[u,S]=n.useState(null),[N,y]=n.useState(!1);n.useEffect(()=>{d()},[]);const d=async()=>{s(!0);try{const a=await w.listAgents();m(a.data.agents||[]),t(a.data.stats||{totalAgents:0,activeAgents:0,inactiveAgents:0})}catch(a){console.error("Failed to fetch agents:",a),m([])}finally{s(!1)}},h=()=>{k(null),j(!0)},i=a=>{k(a),j(!0)},f=()=>{j(!1),k(null)},I=a=>{m(b?l=>l.map(v=>v.id===a.id?a:v):l=>[a,...l]),d()},M=a=>{S(a),r(!0)},D=()=>{S(null),r(!1)},P=async()=>{if(u){y(!0);try{await w.deleteAgent(u.id),m(a=>a.filter(l=>l.id!==u.id)),D(),d()}catch(a){console.error("Failed to delete agent:",a)}finally{y(!1)}}},B=async a=>{const l=a.status==="ACTIVE"?"INACTIVE":"ACTIVE";try{await w.toggleAgentStatus(a.id,l),m(v=>v.map(F=>F.id===a.id?{...F,status:l}:F)),d()}catch(v){console.error("Failed to toggle agent status:",v)}},L=[{title:"Total Agents",value:(c==null?void 0:c.totalAgents)||0,icon:e.jsx(_,{className:"w-6 h-6"}),bgColor:"bg-blue-50",iconColor:"text-blue-600"},{title:"Active Agents",value:(c==null?void 0:c.activeAgents)||0,icon:e.jsx(X,{className:"w-6 h-6"}),bgColor:"bg-green-50",iconColor:"text-green-600"},{title:"Inactive Agents",value:(c==null?void 0:c.inactiveAgents)||0,icon:e.jsx(z,{className:"w-6 h-6"}),bgColor:"bg-red-50",iconColor:"text-red-600"}],O=a=>{switch(a){case"ACTIVE":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400";case"INACTIVE":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},U=n.useMemo(()=>g?p.filter(a=>a.fullName.toLowerCase().includes(g.toLowerCase())||a.email.toLowerCase().includes(g.toLowerCase())):p,[p,g]);return o&&p.length===0?e.jsx($,{show:!0}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Agent Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Manage agents, their wallets, and account status."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.map((a,l)=>e.jsx(H,{...a,loading:o},l))}),e.jsx(V,{loading:o,title:"All Agents",columns:[{key:"fullName",label:"Name"},{key:"email",label:"Email"},{key:"walletBalance",label:"Wallet Balance",render:a=>e.jsxs("span",{className:"font-mono",children:["â‚¹",(a||0).toLocaleString()]})},{key:"status",label:"Status",render:a=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${O(a)}`,children:a})},{key:"actions",label:"Actions",render:(a,l)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>B(l),className:`${l.status==="ACTIVE"?"text-red-500":"text-green-500"} hover:opacity-80 transition-colors`,title:l.status==="ACTIVE"?"Deactivate Account":"Activate Account",children:e.jsx(K,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>i(l),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Edit Agent",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>M(l),className:"text-red-600 hover:text-red-800 transition-colors",title:"Delete Agent",children:e.jsx(G,{className:"w-5 h-5"})})]})}],data:U,onAdd:h,searchPlaceholder:"Search by name or email...",searchTerm:g,onSearchChange:a=>x(a.target.value)}),e.jsx(Q,{isOpen:C,onClose:f,onSuccess:I,agentToEdit:b}),e.jsx(R,{isOpen:A,onClose:D,onConfirm:P,loading:N,title:"Delete Agent",message:`Are you sure you want to delete ${u==null?void 0:u.fullName}? This action cannot be undone and will remove their wallet.`})]})};export{fe as default};
