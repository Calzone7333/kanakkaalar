import{j as t}from"./ui-Ch41-bI7.js";import{r,h as w,b as E}from"./vendor-Con1GFA2.js";import{a as h}from"./index-SiRpZdc4.js";import"./utils-BMGruD9E.js";function O(){const[d,i]=r.useState(!1),[u,n]=r.useState(null),[f]=w(),x=E(),[o,b]=r.useState(""),[m,p]=r.useState(""),[s,g]=r.useState(0);r.useEffect(()=>{const e=f.get("email");e&&b(e)},[f]),r.useEffect(()=>{let e;return s>0&&(e=setInterval(()=>{g(a=>a<=1?(clearInterval(e),0):a-1)},1e3)),()=>clearInterval(e)},[s]);const v=async e=>{var a,l,y;if((a=e==null?void 0:e.preventDefault)==null||a.call(e),!o||!m)return n("Enter email and code");i(!0);try{await h.verifyEmail({email:o,code:m}),n("Email verified. You can now login."),setTimeout(()=>x("/login"),1200)}catch(c){n(((y=(l=c==null?void 0:c.response)==null?void 0:l.data)==null?void 0:y.error)||"Verification failed")}finally{i(!1)}},j=async()=>{var e,a;if(!o)return n("Enter your email to resend OTP");if(!(s>0)){i(!0);try{await h.requestEmailOtp({email:o}),n("Verification code sent to your email."),g(30)}catch(l){n(((a=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:a.error)||"Could not send OTP. Try again later.")}finally{i(!1)}}};return t.jsxs("div",{className:"max-w-md p-6 mx-auto bg-white rounded shadow",children:[t.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Verify Email"}),t.jsxs("form",{onSubmit:v,children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Email"}),t.jsx("input",{value:o,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 mt-2 border rounded",placeholder:"you@domain.com"}),t.jsx("label",{className:"block mt-4 text-sm font-medium text-slate-700",children:"OTP Code"}),t.jsx("input",{value:m,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 mt-2 border rounded",placeholder:"6-digit code"}),t.jsx("button",{disabled:d,className:"mt-4 w-full bg-[#003366] text-white py-2 rounded",children:d?"Verifying...":"Verify"}),t.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[t.jsx("button",{type:"button",onClick:j,disabled:d||s>0,className:`flex-1 py-2 rounded border text-sm ${s>0?"bg-gray-100 text-gray-500 border-gray-200":"bg-white text-[#003366] border-[#003366] hover:bg-blue-50"}`,children:s>0?`Resend in ${s}s`:"Resend OTP"}),t.jsx("button",{type:"button",onClick:()=>x("/login"),className:"flex-1 py-2 text-sm bg-white border border-gray-200 rounded",children:"Back to Login"})]})]}),u&&t.jsx("div",{className:"mt-3 text-sm text-slate-600",children:u})]})}export{O as default};
