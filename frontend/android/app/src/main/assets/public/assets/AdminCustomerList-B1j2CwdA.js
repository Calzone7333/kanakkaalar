import{j as e}from"./ui-Ch41-bI7.js";import{b as N,r as a}from"./vendor-Con1GFA2.js";import{D as C}from"./DataTable-D4UWD7Zb.js";import{r as v}from"./index-SiRpZdc4.js";import{P as w}from"./plus-BBYXCYuW.js";import{E as k}from"./eye-rUo02T12.js";import{S}from"./square-pen-D8nIDyhw.js";import"./search-C-O3bJ5K.js";import"./trash-2-i4V96l9G.js";import"./utils-BMGruD9E.js";const V=()=>{const d=N(),[l,f]=a.useState(""),[i,c]=a.useState(!0),[m,x]=a.useState(null),[n,p]=a.useState([]);a.useEffect(()=>{u()},[]);const u=async()=>{var s,t;try{c(!0),x(null);const y=((await v.getAllProfiles()).data||[]).map(r=>{var h,g,b;return{id:r.id,name:((h=r.user)==null?void 0:h.fullName)||"N/A",email:((g=r.user)==null?void 0:g.email)||"N/A",phone:((b=r.user)==null?void 0:b.phone)||r.whatsappNumber||"N/A",status:r.status||"Active",kycStatus:r.kycStatus||"Pending",walletBalance:0}});p(y)}catch(o){console.error("Error fetching customers:",o),x(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load customers")}finally{c(!1)}},j=n.filter(s=>s.name.toLowerCase().includes(l.toLowerCase())||s.email.toLowerCase().includes(l.toLowerCase()));return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading customers..."})]})}):m?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("p",{className:"text-red-800",children:["Error: ",m]}),e.jsx("button",{onClick:u,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"All Customers"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:[n.length," customer",n.length!==1?"s":""," found"]})]}),e.jsxs("button",{onClick:()=>d("/dashboard/admin/crm"),className:"px-4 py-2 bg-[#0189BB] text-white rounded-lg hover:bg-[#017a9b] font-medium transition-colors flex items-center gap-2",children:[e.jsx(w,{size:18}),"Add Customer"]})]}),e.jsx(C,{loading:i,title:"Customers",columns:[{key:"name",label:"Customer",render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xs",children:s.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: #",t.id]})]})]})},{key:"email",label:"Contact",render:(s,t)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s}),e.jsx("span",{className:"text-xs text-gray-400",children:t.phone})]})},{key:"status",label:"Status",render:s=>e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium
                ${s==="Active"?"bg-green-100 text-green-700":s==="Pending"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-700"}`,children:s})},{key:"kycStatus",label:"KYC",render:s=>e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium
                ${s==="Verified"?"bg-blue-100 text-blue-700":s==="Rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:s})},{key:"walletBalance",label:"Wallet",render:s=>`â‚¹${s}`},{key:"actions",label:"Actions",render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(`/dashboard/admin/crm/customer/${t.id}`),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:"View Profile",children:e.jsx(k,{size:18})}),e.jsx("button",{className:"p-1.5 text-gray-600 hover:bg-gray-50 rounded-md transition-colors",children:e.jsx(S,{size:18})})]})}],data:j,searchPlaceholder:"Search by name or email...",searchTerm:l,onSearchChange:s=>f(s.target.value)})]})};export{V as default};
