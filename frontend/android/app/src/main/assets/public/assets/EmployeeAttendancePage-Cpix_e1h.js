import{j as e}from"./ui-Ch41-bI7.js";import{r as a}from"./vendor-Con1GFA2.js";import{n as i}from"./index-CetDmz67.js";import{c as j,k as d}from"./index-SiRpZdc4.js";import{M}from"./map-pin-Bf0f1u9_.js";import{C as A}from"./circle-check-big-5mARxVgZ.js";import{C as E}from"./clock-BPY9lf2r.js";import{C as H}from"./calendar-DkqJ-Bi6.js";import{H as P}from"./history-BicNU56Q.js";import"./utils-BMGruD9E.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],F=j("circle-x",$);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],R=j("coffee",z);function K(){const[o,m]=a.useState(new Date),[c,n]=a.useState(!1),[h,f]=a.useState(null),[b,x]=a.useState(null),[w,v]=a.useState("00:00:00"),[y,u]=a.useState("Detecting location..."),[k,N]=a.useState([]),[C,T]=a.useState(!0);a.useEffect(()=>{const t=setInterval(()=>m(new Date),1e3);return I(),g(),"geolocation"in navigator?navigator.geolocation.getCurrentPosition(()=>u("Office HQ (Verified)"),()=>u("Remote / Unknown")):u("Location unavailable"),()=>clearInterval(t)},[]);const I=async()=>{try{const t=await d.getToday();if(t.data){const s=t.data;f(s.checkInTime?new Date(s.checkInTime):null),x(s.checkOutTime?new Date(s.checkOutTime):null),n(s.checkInTime&&!s.checkOutTime)}}catch(t){console.error("Failed to fetch today's attendance",t)}finally{T(!1)}},g=async()=>{try{const l=((await d.getMyHistory()).data||[]).slice(0,5).map(r=>({date:new Date(r.date).toLocaleDateString(),checkIn:r.checkInTime?new Date(r.checkInTime).toLocaleTimeString():"-",checkOut:r.checkOutTime?new Date(r.checkOutTime).toLocaleTimeString():"-",status:r.status||"Present",duration:r.duration||"-"}));N(l)}catch(t){console.error("Failed to fetch history",t)}};a.useEffect(()=>{if(c&&h&&!b){const t=setInterval(()=>{const l=new Date-h,r=Math.floor(l/36e5).toString().padStart(2,"0"),O=Math.floor(l%36e5/6e4).toString().padStart(2,"0"),L=Math.floor(l%6e4/1e3).toString().padStart(2,"0");v(`${r}:${O}:${L}`)},1e3);return()=>clearInterval(t)}},[c,h,b]);const S=async()=>{try{const s=(await d.checkIn(y)).data;f(new Date(s.checkInTime)),n(!0),x(null),i.success("Checked in successfully at "+new Date(s.checkInTime).toLocaleTimeString()),g()}catch(t){i.error("Failed to check in"),console.error(t)}},D=async()=>{try{const s=(await d.checkOut()).data;x(new Date(s.checkOutTime)),n(!1),i.success("Checked out successfully at "+new Date(s.checkOutTime).toLocaleTimeString()),g()}catch(t){i.error("Failed to check out"),console.error(t)}};return e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Attendance"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track your daily work hours and attendance history."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#5E33AC] to-[#8155D6] rounded-3xl p-8 text-white shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-64 h-64 bg-white opacity-10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("p",{className:"text-purple-200 font-medium mb-1",children:o.toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("h2",{className:"text-5xl font-bold font-mono tracking-wider",children:o.toLocaleTimeString("en-IN",{hour12:!0})}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 text-purple-100 bg-white/10 px-4 py-2 rounded-full w-fit mx-auto md:mx-0",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:y})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"w-40 h-40 rounded-full border-8 border-white/20 flex items-center justify-center bg-white/10 backdrop-blur-sm relative",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-purple-200 uppercase tracking-wider font-semibold",children:"Work Time"}),e.jsx("p",{className:"text-2xl font-bold font-mono",children:w})]}),c&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-green-400 rounded-full animate-pulse border-2 border-[#5E33AC]"})]}),c?e.jsxs("button",{onClick:D,className:"px-8 py-3 bg-red-500 text-white font-bold rounded-xl shadow-lg hover:bg-red-600 hover:scale-105 transition-all flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5"}),"Check Out"]}):e.jsxs("button",{onClick:S,disabled:C,className:"px-8 py-3 bg-white text-[#5E33AC] font-bold rounded-xl shadow-lg hover:bg-gray-50 hover:scale-105 transition-all flex items-center gap-2 disabled:opacity-50",children:[e.jsx(A,{className:"w-5 h-5"}),"Check In"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsx(p,{icon:e.jsx(E,{className:"w-6 h-6 text-blue-600"}),label:"Avg. Hours",value:"8h 45m",color:"bg-blue-50"}),e.jsx(p,{icon:e.jsx(H,{className:"w-6 h-6 text-purple-600"}),label:"Days Present",value:`${k.filter(t=>t.status==="Present").length} Days`,color:"bg-purple-50"}),e.jsx(p,{icon:e.jsx(R,{className:"w-6 h-6 text-amber-600"}),label:"Leaves Taken",value:"2 Days",color:"bg-amber-50"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 h-fit",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(P,{className:"w-5 h-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Recent History"})]}),e.jsx("div",{className:"space-y-6",children:k.map((t,s)=>e.jsxs("div",{className:"relative pl-6 border-l-2 border-gray-100 last:border-0 pb-6 last:pb-0",children:[e.jsx("div",{className:`absolute -left-[9px] top-0 w-4 h-4 rounded-full border-2 border-white ${t.status==="Present"?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:t.date}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.status==="Present"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.status})]}),e.jsxs("div",{className:"text-xs text-gray-500 grid grid-cols-2 gap-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-gray-400",children:"Check In"}),e.jsx("span",{className:"font-medium",children:t.checkIn})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"block text-gray-400",children:"Check Out"}),e.jsx("span",{className:"font-medium",children:t.checkOut})]})]})]},s))}),e.jsx("button",{className:"w-full mt-6 py-2 text-sm text-[#5E33AC] font-medium hover:bg-purple-50 rounded-lg transition-colors",children:"View Full Report"})]})]})]})}function p({icon:o,label:m,value:c,color:n}){return e.jsxs("div",{className:`p-6 rounded-2xl border border-gray-100 ${n} flex flex-col items-center text-center`,children:[e.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm mb-3",children:o}),e.jsx("p",{className:"text-sm text-gray-600 font-medium mb-1",children:m}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:c})]})}export{K as default};
