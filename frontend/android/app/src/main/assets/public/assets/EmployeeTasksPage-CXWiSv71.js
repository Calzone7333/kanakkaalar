import{j as e}from"./ui-Ch41-bI7.js";import{r as a,b as C}from"./vendor-Con1GFA2.js";import{c as L,R as I,g as D,o as h}from"./index-SiRpZdc4.js";import{n as d}from"./index-CetDmz67.js";import{S as P}from"./search-C-O3bJ5K.js";import{F as R}from"./funnel-Dg4FZA-7.js";import{C as k}from"./clipboard-check-Cee7hyQR.js";import{C as T}from"./calendar-DkqJ-Bi6.js";import{U as G}from"./user-BfTdGItp.js";import{I as O}from"./indian-rupee-CkBkjmAn.js";import{E as _}from"./eye-rUo02T12.js";import"./utils-BMGruD9E.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],M=L("play",F);function Z(){const[c,p]=a.useState([]),[m,x]=a.useState([]),[i,y]=a.useState("ALL"),[o,b]=a.useState(""),[j,N]=a.useState(!0),[u,g]=a.useState(!1),w=C(),n=async()=>{g(!0);try{const s=D(),t=s==null?void 0:s.user;if(!t||!t.email)return;const l=await h.listAssigned(t.email);console.log("EmployeeTasksPage: Fetched tasks for",t.email,l);const f=(Array.isArray(l.data)?l.data:[]).map(r=>({id:r.id,title:r.title||r.serviceName||`Order #${r.id}`,customer:r.customerName||r.customerEmail||"Unknown",totalAmount:r.totalAmount||0,createdAt:r.createdAt||r.created_at,status:r.status||"ASSIGNED",documents:r.documents||[]}));p(f),x(f)}catch(s){console.error("Error loading tasks:",s),d.error("Failed to load tasks")}finally{g(!1),N(!1)}};a.useEffect(()=>{n()},[]),a.useEffect(()=>{let s=c;if(i!=="ALL"&&(s=s.filter(t=>t.status===i)),o){const t=o.toLowerCase();s=s.filter(l=>l.title.toLowerCase().includes(t)||l.customer.toLowerCase().includes(t)||String(l.id).includes(t))}x(s)},[i,o,c]);const v=s=>w(`/dashboard/employee/task/${s}`),S=async s=>{try{await h.update(s,{status:"IN_PROGRESS"}),d.success("Task started successfully!"),n()}catch(t){console.error("Error starting task:",t),d.error("Failed to start task")}},E=s=>{switch(s){case"ASSIGNED":return"bg-indigo-100 text-indigo-700 border-indigo-200";case"IN_PROGRESS":return"bg-amber-100 text-amber-700 border-amber-200";case"COMPLETED":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"CANCELLED":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},A=s=>{switch(s){case"ASSIGNED":return 25;case"IN_PROGRESS":return 60;case"COMPLETED":return 100;default:return 0}};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Tasks"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track your assigned client projects"})]}),e.jsxs("button",{onClick:n,disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors shadow-sm",children:[e.jsx(I,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"Refresh List"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search tasks, clients, or IDs...",value:o,onChange:s=>b(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#5E33AC] focus:bg-white transition-all"})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsx(R,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:i,onChange:s=>y(s.target.value),className:"w-full md:w-48 px-4 py-2 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#5E33AC] cursor-pointer",children:[e.jsx("option",{value:"ALL",children:"All Statuses"}),e.jsx("option",{value:"ASSIGNED",children:"Assigned"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]}),j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading your tasks..."})]}):m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border border-dashed border-gray-300 rounded-2xl",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(k,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No tasks found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Try adjusting your filters or search query."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:m.map(s=>{const t=A(s.status);return e.jsxs("div",{className:"group bg-white border border-gray-200 rounded-2xl overflow-hidden hover:shadow-lg transition-all duration-300 flex flex-col",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full border ${E(s.status)}`,children:s.status.replace(/_/g," ")}),e.jsxs("span",{className:"text-xs text-gray-400 font-mono",children:["#",s.id]})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 line-clamp-1",title:s.title,children:s.title}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-1",children:[e.jsx(T,{className:"w-3.5 h-3.5 mr-1"}),s.createdAt?new Date(s.createdAt).toLocaleDateString("en-IN"):"N/A"]})]}),e.jsxs("div",{className:"p-5 space-y-4 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-50 flex items-center justify-center text-indigo-600",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Client"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-[200px]",title:s.customer,children:s.customer})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-50 flex items-center justify-center text-emerald-600",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Value"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.totalAmount.toLocaleString("en-IN")})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1.5",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Progress"}),e.jsxs("span",{className:"text-indigo-600 font-bold",children:[t,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out ${t===100?"bg-emerald-500":"bg-[#5E33AC]"}`,style:{width:`${t}%`}})})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-100 flex gap-3",children:[e.jsxs("button",{onClick:()=>v(s.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-white border border-gray-200 text-gray-700 text-sm font-medium rounded-xl hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm",children:[e.jsx(_,{className:"w-4 h-4"}),"Details"]}),s.status==="ASSIGNED"&&e.jsxs("button",{onClick:()=>S(s.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-[#5E33AC] text-white text-sm font-medium rounded-xl hover:bg-[#4a288a] transition-all shadow-md shadow-indigo-200",children:[e.jsx(M,{className:"w-4 h-4"}),"Start"]})]})]},s.id)})})]})}export{Z as default};
