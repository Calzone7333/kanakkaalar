import{j as t}from"./ui-B7g2UBO6.js";import{r,h as w,b as N}from"./vendor-BMI_syx-.js";import{a as h}from"./utils-Dw7OLvbZ.js";function S(){const[d,i]=r.useState(!1),[u,o]=r.useState(null),[f]=w(),x=N(),[l,b]=r.useState(""),[m,y]=r.useState(""),[s,p]=r.useState(0);r.useEffect(()=>{const e=f.get("email");e&&b(e)},[f]),r.useEffect(()=>{let e;return s>0&&(e=setInterval(()=>{p(a=>a<=1?(clearInterval(e),0):a-1)},1e3)),()=>clearInterval(e)},[s]);const v=async e=>{var a,n,g;if((a=e==null?void 0:e.preventDefault)==null||a.call(e),!l||!m)return o("Enter email and code");i(!0);try{await h.post("/api/auth/verify-email",{email:l,code:m}),o("Email verified. You can now login."),setTimeout(()=>x("/login"),1200)}catch(c){o(((g=(n=c==null?void 0:c.response)==null?void 0:n.data)==null?void 0:g.error)||"Verification failed")}finally{i(!1)}},j=async()=>{var e,a;if(!l)return o("Enter your email to resend OTP");if(!(s>0)){i(!0);try{await h.post("/api/auth/request-email-otp",{email:l}),o("Verification code sent to your email."),p(30)}catch(n){o(((a=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:a.error)||"Could not send OTP. Try again later.")}finally{i(!1)}}};return t.jsxs("div",{className:"max-w-md p-6 mx-auto bg-white rounded shadow",children:[t.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Verify Email"}),t.jsxs("form",{onSubmit:v,children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Email"}),t.jsx("input",{value:l,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 mt-2 border rounded",placeholder:"you@domain.com"}),t.jsx("label",{className:"block mt-4 text-sm font-medium text-slate-700",children:"OTP Code"}),t.jsx("input",{value:m,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 mt-2 border rounded",placeholder:"6-digit code"}),t.jsx("button",{disabled:d,className:"mt-4 w-full bg-[#003366] text-white py-2 rounded",children:d?"Verifying...":"Verify"}),t.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[t.jsx("button",{type:"button",onClick:j,disabled:d||s>0,className:`flex-1 py-2 rounded border text-sm ${s>0?"bg-gray-100 text-gray-500 border-gray-200":"bg-white text-[#003366] border-[#003366] hover:bg-blue-50"}`,children:s>0?`Resend in ${s}s`:"Resend OTP"}),t.jsx("button",{type:"button",onClick:()=>x("/login"),className:"flex-1 py-2 text-sm bg-white border border-gray-200 rounded",children:"Back to Login"})]})]}),u&&t.jsx("div",{className:"mt-3 text-sm text-slate-600",children:u})]})}export{S as default};
